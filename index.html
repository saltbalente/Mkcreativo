<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MK Innovador Marketing</title>
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <!-- Header with Logo -->
    <header class="header">
        <div class="container">
            <img src="img/mkcreativo-logo.svg" alt="mkCreativo" class="logo">
            
            <!-- Desktop Navigation -->
            <nav class="nav-menu desktop-nav" id="nav-menu">
                <a href="index.html">Inicio</a>
                <a href="login.html" id="login-link">Iniciar Sesión</a>
                <a href="register.html" id="register-link">Registrarse</a>
                <a href="profile.html" id="profile-link" style="display: none;">Mi Perfil</a>
                <a href="#" id="logout-link" style="display: none;" onclick="signOut()">Cerrar Sesión</a>
                <a href="privacy.html">Privacidad</a>
            </nav>
            
            <!-- Mobile Hamburger Button -->
            <button class="hamburger-btn" id="hamburger-btn" onclick="toggleMobileMenu()">
                <span></span>
                <span></span>
                <span></span>
            </button>
            
            <!-- Mobile Navigation -->
            <nav class="mobile-nav" id="mobile-nav">
                <div class="mobile-nav-content">
                    <a href="index.html" onclick="closeMobileMenu()">Inicio</a>
                    <a href="login.html" id="mobile-login-link" onclick="closeMobileMenu()">Iniciar Sesión</a>
                    <a href="register.html" id="mobile-register-link" onclick="closeMobileMenu()">Registrarse</a>
                    <a href="profile.html" id="mobile-profile-link" style="display: none;" onclick="closeMobileMenu()">Mi Perfil</a>
                    <a href="#" id="mobile-logout-link" style="display: none;" onclick="signOut(); closeMobileMenu();">Cerrar Sesión</a>
                    <a href="privacy.html" onclick="closeMobileMenu()">Privacidad</a>
                </div>
            </nav>
        </div>
    </header>

    <!-- Hero Section -->
    <section id="hero" class="hero-section">
        <div class="container">
            <h1>Transformamos Tu Negocio en una Máquina de Ventas Digital</h1>
            <p>Ecosistemas digitales que generan ROI real. No ofrecemos servicios de redes sociales, nos enfocamos en resultados medibles</p>
            <a href="#contact" class="btn-primary">Agenda Tu Consultoría Gratuita</a>
        </div>
    </section>

    <!-- Services Section -->
    <section id="services" class="services-section">
        <div class="container">
            <h2>Nuestros Servicios</h2>
            <div class="service-cards">
                <div class="card">
                    <h3>BÁSICO</h3>
                    <p class="price">$600K/mes</p>
                    <ul>
                        <li>Web básica</li>
                        <li>Pauta publicitaria</li>
                        <li>Email marketing</li>
                        <li>SEO básico</li>
                    </ul>
                </div>
                <div class="card">
                    <h3>PROFESIONAL</h3>
                    <p class="price">$1.4M/mes</p>
                    <ul>
                        <li>Web con e-commerce</li>
                        <li>Pauta avanzada</li>
                        <li>Automation</li>
                        <li>SEO intermedio</li>
                    </ul>
                </div>
                <div class="card">
                    <h3>PREMIUM</h3>
                    <p class="price">$2.8M/mes</p>
                    <ul>
                        <li>Web premium</li>
                        <li>Pauta completa</li>
                        <li>CRM</li>
                        <li>SEO avanzado</li>
                        <li>Fotografía</li>
                    </ul>
                </div>
                <div class="card">
                    <h3>ENTERPRISE</h3>
                    <p class="price">$5.5M/mes</p>
                    <ul>
                        <li>Ecosistema completo</li>
                        <li>Video marketing</li>
                        <li>Desarrollo personalizado</li>
                        <li>Consultoría</li>
                    </ul>
                </div>
            </div>
        </div>
    </section>

    <!-- Proceso Section -->
    <section id="process" class="process-section">
        <div class="container">
            <h2>Nuestro Proceso</h2>
            <div class="process-steps">
                <div class="step">
                    <h3>1. Análisis y Estrategia</h3>
                    <p>Comprendemos tus objetivos y diseñamos un plan a medida.</p>
                </div>
                <div class="step">
                    <h3>2. Desarrollo y Optimización</h3>
                    <p>Construimos tu ecosistema digital con las mejores prácticas.</p>
                </div>
                <div class="step">
                    <h3>3. Lanzamiento y Gestión</h3>
                    <p>Implementamos las campañas y monitoreamos su rendimiento.</p>
                </div>
                <div class="step">
                    <h3>4. Medición y Mejora Continua</h3>
                    <p>Analizamos los resultados para optimizar el ROI.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Resultados Section -->
    <section id="results" class="results-section">
        <div class="container">
            <h2>Resultados que Impresionan</h2>
            <div class="results-grid">
                <div class="metric-card">
                    <h3>Crecimiento Sostenible</h3>
                    <p>Estrategias que escalan tu negocio de forma consistente</p>
                </div>
                <div class="metric-card">
                    <h3>74-155</h3>
                    <p>Clientes satisfechos</p>
                </div>
                <div class="metric-card">
                    <h3>ROI Medible</h3>
                    <p>Enfocados en el retorno de inversión</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Testimonios Section -->
    <section id="testimonials" class="testimonials-section">
        <div class="container">
            <h2>Lo que Dicen Nuestros Clientes</h2>
            <div class="testimonial-cards">
                <div class="testimonial-card">
                    <img src="img/testimonial1.jpg" alt="Cliente 1">
                    <p>"MK Innovador transformó nuestra presencia digital. ¡Resultados asombrosos!"</p>
                    <h4>- María González, CEO TechStart</h4>
                </div>
                <div class="testimonial-card">
                    <img src="img/testimonial2.jpg" alt="Cliente 2">
                    <p>"Su enfoque en el ROI es único. Vimos un crecimiento real en poco tiempo."</p>
                    <h4>- Carlos Rodríguez, Director Marketing</h4>
                </div>
                <div class="testimonial-card">
                    <img src="img/testimonial3.jpg" alt="Cliente 3">
                    <p>"Profesionales y eficientes. La mejor inversión que hemos hecho."</p>
                    <h4>- Ana Martínez, Fundadora EcoShop</h4>
                </div>
            </div>
        </div>
    </section>

    <!-- FAQ Section -->
    <section id="faq" class="faq-section">
        <div class="container">
            <h2>Preguntas Frecuentes</h2>
            <div class="faq-items">

                <div class="faq-item">
                    <h3>¿Cómo miden el ROI?</h3>
                    <p>Implementamos sistemas de seguimiento avanzados para cada campaña, proporcionando informes detallados sobre el retorno de tu inversión.</p>
                </div>
                <div class="faq-item">
                    <h3>¿Qué tipo de empresas atienden?</h3>
                    <p>Trabajamos con empresas de diversos tamaños y sectores que buscan escalar sus ventas a través de ecosistemas digitales.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Contact Section -->
    <section id="contact" class="contact-section">
        <div class="container">
            <h2>Agenda Tu Consultoría Gratuita</h2>
            <form class="contact-form">
                <input type="text" placeholder="Tu Nombre" required>
                <input type="email" placeholder="Tu Email" required>
                <textarea placeholder="Tu Mensaje" rows="5"></textarea>
                <button type="submit" class="btn-primary">Enviar Mensaje</button>
            </form>
            <p class="contact-info">O contáctanos directamente: info@mkinnovador.com</p>
        </div>
    </section>

    <!-- WhatsApp Button -->
    <a href="https://wa.me/YOUR_PHONE_NUMBER" class="whatsapp-btn" target="_blank">
        <img src="img/whatsapp-icon.svg" alt="WhatsApp">
    </a>

    <!-- Supabase -->
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script src="js/supabase-config.js"></script>
    <script src="js/script.js"></script>
    <script>
        // Función para cerrar sesión
        async function signOut() {
            try {
                const { error } = await supabaseClient.auth.signOut();
                if (error) throw error;
                
                alert('Sesión cerrada correctamente');
                updateNavigation(false);
            } catch (error) {
                console.error('Error cerrando sesión:', error);
                alert('Error al cerrar sesión');
            }
        }

        // Función para actualizar la navegación según el estado de autenticación
        function updateNavigation(isLoggedIn, userName = '', isAdmin = false) {
            console.log('updateNavigation called:', { isLoggedIn, userName, isAdmin });
            
            // Enlaces del menú desktop
            const loginLink = document.getElementById('login-link');
            const registerLink = document.getElementById('register-link');
            const profileLink = document.getElementById('profile-link');
            const logoutLink = document.getElementById('logout-link');
            
            // Enlaces del menú móvil
            const mobileLoginLink = document.getElementById('mobile-login-link');
            const mobileRegisterLink = document.getElementById('mobile-register-link');
            const mobileProfileLink = document.getElementById('mobile-profile-link');
            const mobileLogoutLink = document.getElementById('mobile-logout-link');
            
            console.log('Mobile profile link found:', mobileProfileLink);

            if (isLoggedIn) {
                // Usuario logueado: ocultar login/registro, mostrar perfil/logout
                // Desktop
                loginLink.style.display = 'none';
                registerLink.style.display = 'none';
                profileLink.style.display = 'inline';
                logoutLink.style.display = 'inline';
                
                // Mobile
                mobileLoginLink.style.display = 'none';
                mobileRegisterLink.style.display = 'none';
                mobileProfileLink.style.display = 'block';
                mobileLogoutLink.style.display = 'block';
                
                // Configurar enlace según el rol del usuario
                if (isAdmin) {
                    console.log('Setting admin links for user:', userName);
                    // Admin: enlace al panel de administrador
                    profileLink.href = 'admin.html';
                    profileLink.textContent = userName || 'Admin Panel';
                    profileLink.title = 'Ir al panel de administrador';
                    
                    mobileProfileLink.href = 'admin.html';
                    mobileProfileLink.textContent = userName || 'Admin Panel';
                    console.log('Mobile profile link set to:', mobileProfileLink.href, mobileProfileLink.textContent);
                } else {
                    // Usuario normal: enlace al perfil
                    profileLink.href = 'profile.html';
                    mobileProfileLink.href = 'profile.html';
                    
                    if (userName) {
                        profileLink.textContent = userName;
                        profileLink.title = 'Ver mi perfil';
                        mobileProfileLink.textContent = userName;
                    } else {
                        profileLink.textContent = 'Mi Perfil';
                        mobileProfileLink.textContent = 'Mi Perfil';
                    }
                }
            } else {
                // Usuario no logueado: mostrar login/registro, ocultar perfil/logout
                // Desktop
                loginLink.style.display = 'inline';
                registerLink.style.display = 'inline';
                profileLink.style.display = 'none';
                logoutLink.style.display = 'none';
                
                // Mobile
                mobileLoginLink.style.display = 'block';
                mobileRegisterLink.style.display = 'block';
                mobileProfileLink.style.display = 'none';
                mobileLogoutLink.style.display = 'none';
            }
        }

        // Verificar estado de autenticación al cargar la página
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                const { data: { user } } = await supabaseClient.auth.getUser();
                
                if (user) {
                    // Usuario autenticado
                    let userName = user.user_metadata?.full_name || user.email;
                    let isAdmin = false;
                    
                    // Intentar obtener el nombre del perfil
                    try {
                        const { data: profile } = await supabaseClient
                            .from('user_profiles')
                            .select('full_name')
                            .eq('id', user.id)
                            .single();
                        
                        if (profile && profile.full_name) {
                            userName = profile.full_name;
                        }
                    } catch (profileError) {
                        console.log('No se pudo obtener el perfil:', profileError);
                    }
                    
                    // Verificar si es administrador
                    try {
                        const { data: adminCheck, error: adminError } = await supabaseClient
                            .rpc('is_admin');
                        if (adminError) {
                            console.error('Error verificando rol de admin:', adminError);
                        } else {
                            isAdmin = adminCheck === true;
                            console.log('Admin check result:', adminCheck, 'isAdmin:', isAdmin);
                        }
                    } catch (adminError) {
                        console.error('Error verificando rol de admin:', adminError);
                    }
                    
                    updateNavigation(true, userName, isAdmin);
                } else {
                    // Usuario no autenticado
                    updateNavigation(false);
                }
            } catch (error) {
                console.log('Error verificando autenticación:', error);
                updateNavigation(false);
            }
        });

        // Escuchar cambios en el estado de autenticación
        supabaseClient.auth.onAuthStateChange(async (event, session) => {
            if (event === 'SIGNED_IN' && session) {
                const user = session.user;
                let userName = user.user_metadata?.full_name || user.email;
                let isAdmin = false;
                
                // Verificar si es administrador
                try {
                    const { data: adminCheck, error: adminError } = await supabaseClient
                        .rpc('is_admin');
                    if (adminError) {
                        console.error('Error verificando rol de admin:', adminError);
                    } else {
                        isAdmin = adminCheck === true;
                        console.log('Admin check result (auth change):', adminCheck, 'isAdmin:', isAdmin);
                    }
                } catch (adminError) {
                    console.error('Error verificando rol de admin:', adminError);
                }
                
                updateNavigation(true, userName, isAdmin);
            } else if (event === 'SIGNED_OUT') {
                updateNavigation(false);
            }
        });
    </script>
    
    <!-- Mobile Menu JavaScript -->
    <script>
        function toggleMobileMenu() {
            const mobileNav = document.getElementById('mobile-nav');
            const hamburgerBtn = document.getElementById('hamburger-btn');
            
            mobileNav.classList.toggle('active');
            hamburgerBtn.classList.toggle('active');
            
            // Prevenir scroll del body cuando el menú está abierto
            if (mobileNav.classList.contains('active')) {
                document.body.style.overflow = 'hidden';
            } else {
                document.body.style.overflow = 'auto';
            }
        }
        
        function closeMobileMenu() {
            const mobileNav = document.getElementById('mobile-nav');
            const hamburgerBtn = document.getElementById('hamburger-btn');
            
            mobileNav.classList.remove('active');
            hamburgerBtn.classList.remove('active');
            document.body.style.overflow = 'auto';
        }
        
        // Cerrar menú al hacer clic fuera de él
        document.addEventListener('click', function(event) {
            const mobileNav = document.getElementById('mobile-nav');
            const hamburgerBtn = document.getElementById('hamburger-btn');
            
            if (mobileNav.classList.contains('active') && 
                !mobileNav.contains(event.target) && 
                !hamburgerBtn.contains(event.target)) {
                closeMobileMenu();
            }
        });
        
        // Cerrar menú al presionar Escape
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeMobileMenu();
            }
        });
    </script>
</body>
</html>


